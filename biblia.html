<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bíblia Católica - Rosarium</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <button class="btn-back" onclick="goBack()">← Voltar</button>
      <div class="header-title">
        <div class="header-logo">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
          </svg>
        </div>
        <span>Bíblia Católica</span>
      </div>
    </div>
  </header>

  <!-- Conteúdo -->
  <div class="page-container">
    <div class="page-content container-md">
      <h1 class="page-title">Bíblia Católica</h1>
      <p class="page-description">73 livros - Antigo e Novo Testamento</p>

      <!-- Pesquisa -->
      <div class="biblia-search" style="margin-bottom: 2rem;">
        <input 
          type="text" 
          class="biblia-search-input input" 
          id="search-input" 
          placeholder="Pesquisar livro..."
          onkeyup="filterBooks()"
        >
      </div>

      <!-- Lista de Livros -->
      <div class="biblia-list" id="books-list">
        <!-- Gerado por JavaScript -->
      </div>

      <!-- Leitor de Bíblia (oculto inicialmente) -->
      <div id="reader-container" class="hidden">
        <div class="biblia-reader">
          <div class="biblia-reader-header">
            <h2 class="biblia-reader-title" id="reader-title">Gênesis 1</h2>
            <div class="biblia-reader-nav">
              <button class="btn btn-sm" onclick="previousChapter()">← Anterior</button>
              <button class="btn btn-sm" onclick="nextChapter()">Próximo →</button>
              <button class="btn btn-sm btn-outline" onclick="closeReader()">Fechar</button>
            </div>
          </div>
          <div class="biblia-verses" id="verses-container">
            <!-- Gerado por JavaScript -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
  <script>
    let currentBook = null;
    let currentChapter = 1;

    async function initBooks() {
      const booksList = document.getElementById('books-list');
      const livros = App.Biblia.getLivros();
      
      livros.forEach(livro => {
        const bookElement = document.createElement('a');
        bookElement.href = '#';
        bookElement.className = 'biblia-book';
        bookElement.onclick = (e) => {
          e.preventDefault();
          openBook(livro.nome);
        };
        
        bookElement.innerHTML = `
          <div class="biblia-book-title">${livro.nome}</div>
          <div class="biblia-book-chapters">${livro.capitulos} capítulo${livro.capitulos > 1 ? 's' : ''}</div>
        `;
        
        booksList.appendChild(bookElement);
      });
    }

    function filterBooks() {
      const searchTerm = document.getElementById('search-input').value.toLowerCase();
      const books = document.querySelectorAll('.biblia-book');
      
      books.forEach(book => {
        const title = book.querySelector('.biblia-book-title').textContent.toLowerCase();
        if (title.includes(searchTerm)) {
          book.style.display = 'block';
        } else {
          book.style.display = 'none';
        }
      });
    }

    async function openBook(bookName) {
      currentBook = bookName;
      currentChapter = 1;
      
      document.getElementById('books-list').classList.add('hidden');
      document.getElementById('search-input').parentElement.classList.add('hidden');
      document.getElementById('reader-container').classList.remove('hidden');
      
      await loadChapter();
    }

    async function loadChapter() {
      const biblia = await App.Biblia.getBiblia(currentBook);
      
      if (!biblia.chapters || biblia.chapters.length === 0) {
        document.getElementById('verses-container').innerHTML = '<p>Capítulo não encontrado</p>';
        return;
      }
      
      const chapter = biblia.chapters[currentChapter - 1];
      if (!chapter) {
        document.getElementById('verses-container').innerHTML = '<p>Capítulo não encontrado</p>';
        return;
      }
      
      document.getElementById('reader-title').textContent = `${currentBook} ${currentChapter}`;
      
      const versesContainer = document.getElementById('verses-container');
      versesContainer.innerHTML = '';
      
      if (chapter.verses) {
        chapter.verses.forEach(verse => {
          const verseElement = document.createElement('div');
          verseElement.className = 'biblia-verse';
          verseElement.innerHTML = `
            <span class="biblia-verse-number">${verse.number}</span>
            <span>${verse.text}</span>
          `;
          versesContainer.appendChild(verseElement);
        });
      }
    }

    function previousChapter() {
      if (currentChapter > 1) {
        currentChapter--;
        loadChapter();
      }
    }

    function nextChapter() {
      const livro = App.Biblia.getLivros().find(l => l.nome === currentBook);
      if (livro && currentChapter < livro.capitulos) {
        currentChapter++;
        loadChapter();
      }
    }

    function closeReader() {
      currentBook = null;
      currentChapter = 1;
      
      document.getElementById('books-list').classList.remove('hidden');
      document.getElementById('search-input').parentElement.classList.remove('hidden');
      document.getElementById('reader-container').classList.add('hidden');
      document.getElementById('search-input').value = '';
      filterBooks();
    }

    // Inicializar
    document.addEventListener('DOMContentLoaded', initBooks);
  </script>
</body>
</html>
