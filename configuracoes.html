<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Configurações - Rosarium</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <button class="btn-back" onclick="goBack()">← Voltar</button>
      <div class="header-title">
        <div class="header-logo">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
        </div>
        <span>Configurações</span>
      </div>
    </div>
  </header>

  <!-- Conteúdo -->
  <div class="page-container">
    <div class="page-content container-md">
      <h1 class="page-title">Configurações</h1>

      <!-- Segurança -->
      <div class="card" style="margin-bottom: 2rem;">
        <h3 class="card-title">Segurança</h3>
        <div class="card-content">
          <div class="form-group">
            <label class="label">PIN Atual (4 dígitos):</label>
            <input type="password" class="input" id="current-pin" placeholder="Digite seu PIN atual">
          </div>
          
          <div class="form-group">
            <label class="label">Novo PIN (4 dígitos):</label>
            <input type="password" class="input" id="new-pin" placeholder="Digite o novo PIN" maxlength="4">
          </div>
          
          <div class="form-group">
            <label class="label">Confirmar PIN:</label>
            <input type="password" class="input" id="confirm-pin" placeholder="Confirme o novo PIN" maxlength="4">
          </div>
          
          <button class="btn" onclick="changePin()" style="width: 100%;">Alterar PIN</button>
        </div>
      </div>

      <!-- Dados -->
      <div class="card" style="margin-bottom: 2rem;">
        <h3 class="card-title">Dados e Privacidade</h3>
        <div class="card-content">
          <p style="margin-bottom: 1rem; color: var(--muted-foreground);">
            Todos os seus dados são salvos localmente no seu dispositivo e nunca são enviados para servidores externos.
          </p>
          
          <button class="btn btn-outline" onclick="exportData()" style="width: 100%; margin-bottom: 1rem;">
            Exportar Dados
          </button>
          
          <button class="btn btn-outline" onclick="clearAllData()" style="width: 100%; color: var(--destructive);">
            Limpar Todos os Dados
          </button>
        </div>
      </div>

      <!-- Sobre -->
      <div class="card" style="margin-bottom: 2rem;">
        <h3 class="card-title">Sobre</h3>
        <div class="card-content">
          <p><strong>Rosarium</strong></p>
          <p style="color: var(--muted-foreground); margin-bottom: 1rem;">v1.0.0</p>
          
          <p style="margin-bottom: 1rem;">
            Um aplicativo de devoção católica para ajudá-lo em sua jornada espiritual.
          </p>
          
          <p style="font-size: var(--font-size-sm); color: var(--muted-foreground);">
            Desenvolvido com ❤️ para a comunidade católica
          </p>
        </div>
      </div>

      <!-- Funcionalidades -->
      <div class="card">
        <h3 class="card-title">Funcionalidades</h3>
        <div class="card-content">
          <ul style="list-style: none; padding: 0;">
            <li style="padding: 0.5rem 0; border-bottom: 1px solid var(--border);">✓ Terço Mariano, Rosário e Terço da Misericórdia</li>
            <li style="padding: 0.5rem 0; border-bottom: 1px solid var(--border);">✓ Bíblia Católica com 73 livros</li>
            <li style="padding: 0.5rem 0; border-bottom: 1px solid var(--border);">✓ Liturgia Diária e Lectio Divina</li>
            <li style="padding: 0.5rem 0; border-bottom: 1px solid var(--border);">✓ Anotações Privadas com PIN</li>
            <li style="padding: 0.5rem 0; border-bottom: 1px solid var(--border);">✓ Santo do Dia</li>
            <li style="padding: 0.5rem 0;">✓ Exame de Consciência para Confissão</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
  <script>
    function changePin() {
      const currentPin = document.getElementById('current-pin').value;
      const newPin = document.getElementById('new-pin').value;
      const confirmPin = document.getElementById('confirm-pin').value;
      
      if (!currentPin || !newPin || !confirmPin) {
        alert('Preencha todos os campos');
        return;
      }
      
      if (!PIN.verify(currentPin)) {
        alert('PIN atual incorreto');
        return;
      }
      
      if (newPin.length !== 4 || confirmPin.length !== 4) {
        alert('O PIN deve ter 4 dígitos');
        return;
      }
      
      if (newPin !== confirmPin) {
        alert('Os PINs não conferem');
        return;
      }
      
      PIN.setPin(newPin);
      alert('PIN alterado com sucesso!');
      
      document.getElementById('current-pin').value = '';
      document.getElementById('new-pin').value = '';
      document.getElementById('confirm-pin').value = '';
    }

    function exportData() {
      const data = {
        terco: Terco.getTercoCalendar(),
        anotacoes: Anotacoes.getAnotacoes(),
        confissoes: Confissao.getConfissoes(),
        exportDate: new Date().toISOString()
      };
      
      const dataStr = JSON.stringify(data, null, 2);
      const dataBlob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(dataBlob);
      
      const link = document.createElement('a');
      link.href = url;
      link.download = `misericordia-dados-${new Date().toISOString().split('T')[0]}.json`;
      link.click();
      
      URL.revokeObjectURL(url);
      alert('Dados exportados com sucesso!');
    }

    function clearAllData() {
      if (!confirm('Tem certeza? Todos os dados serão perdidos permanentemente.')) {
        return;
      }
      
      if (!confirm('ÚLTIMA CONFIRMAÇÃO: Deseja realmente limpar todos os dados?')) {
        return;
      }
      
      localStorage.clear();
      alert('Todos os dados foram limpos.');
      window.location.href = 'home.html';
    }
  </script>
</body>
</html>
